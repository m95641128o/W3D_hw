<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Christmas Tree</title>
	</head>
	<body>
		<div style="position:absolute;top:10px;left:30px;height:250px;width:100px;border-radius:10px;border:1px solid;" align=center>
			<p style="font-size:20px;">功能選單</p>
			<button id="on">開啟</button><br>
			<button id="off">關閉</button><br>
			<button id="easy">簡單模式</button><br>
			<button id="hard">複雜模式</button><br>
		</div>
		
		<div>
			<!--
			<div id="light" style="position:absolute;top:10vw;left:30vw;  
				background:pink;width:20px;height:20px;  
				border-radius:15px;z-index:1"></div>
			-->
			<img src="christmas_tree.jpg" style="position:absolute;top:10px;left:35vw;width:30vw;z-index:-1">
		</div>
		
		<style>
			body{
				font-family:Microsoft JhengHei;
			}
			button{
				height:30px;width:80px;margin:5px;border-radius:3px;font-family:Microsoft JhengHei;
			}
		</style>
		
		<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
		<script>
			class Light {
  
			  constructor(Top,Left) {  
				// create/append div dynamically
				// https://stackoverflow.com/questions/14004117/create-div-and-append-div-dynamically
				this.element = document.createElement ('div');
				//this = iDiv;
				this.element.id = 'light';
				// set element style attribute
				//https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/style
				this.element.style.cssText = "position:absolute;width:1vw;height:1vw;border-radius:15px;z-index:1"; 
				this.element.style.top = Top;
				this.element.style.left = Left;
				// CSS color property: https://www.w3schools.com/cssref/pr_text_color.asp
				// hsl: https://www.w3schools.com/colors/colors_hsl.asp
				this.element.style.background = "hsl(0, 100%, 51%)";
				document.getElementsByTagName('body')[0].appendChild(this.element);
			  }

			  changeColor() {
				// https://stackoverflow.com/questions/45147661/javascript-recursion-within-a-class/45147713
				var self = this;
				var hue = Math.random()*360;
				self.element.style.background = "hsl(" + hue + ", 100%, 51%)";  
				setTimeout (function() { self.changeColor() } , 500);
				//setTimeout ( self.changeColor , 1000);  // why this is not working ...
			  }
			  
			  changeColor_slow(){
				var self = this;
				var hue = Math.random()*360;
				var time = Math.random()*2000+1000;
				self.element.style.background = "hsl(" + hue + ", 100%, 51%)";  
				setTimeout (function() { self.changeColor() } , time);
			  }
			  
			  changeColor_off(){
				var self=this;
				self.element.style.background="hsl(0, 0%, 51%)";
			  }

			}
			////////////////////////////////////////////////////////////////////////////////
			function init(top1,left1) {
			  var light = new Light(top1,left1);
			  light.changeColor();
			}
			
			function close(top1,left1){
			  var light = new Light(top1,left1);
			  light.changeColor_off();
			}
			
			function init2(top1,left1) {
			  var light = new Light(top1,left1);
			  light.changeColor_slow();
			}
			
			function turnOn(){
				init('17.5vw','45.5vw');
				init('17.5vw','52.5vw');
				
				init('19.5vw','49vw');
				
				init('21.5vw','45.5vw');
				init('21.5vw','52.5vw');
				
				init('23.5vw','42vw');
				init('23.5vw','49vw');
				init('23.5vw','56vw');
				
				init('25.5vw','45.5vw');
				init('25.5vw','52.5vw');
				
				init('27.5vw','42vw');
				init('27.5vw','49vw');
				init('27.5vw','56vw');
				
				init('29.5vw','38.5vw');
				init('29.5vw','45.5vw');
				init('29.5vw','52.5vw');
				init('29.5vw','59.5vw');
			}
			
			function turnOff(){
				close('17.5vw','45.5vw');
				close('17.5vw','52.5vw');
				
				close('19.5vw','49vw');
				
				close('21.5vw','45.5vw');
				close('21.5vw','52.5vw');
				
				close('23.5vw','42vw');
				close('23.5vw','49vw');
				close('23.5vw','56vw');
				
				close('25.5vw','45.5vw');
				close('25.5vw','52.5vw');
				
				close('27.5vw','42vw');
				close('27.5vw','49vw');
				close('27.5vw','56vw');
				
				close('29.5vw','38.5vw');
				close('29.5vw','45.5vw');
				close('29.5vw','52.5vw');
				close('29.5vw','59.5vw');
			}
			
			function turnHard(){
				init2('17.5vw','45.5vw');
				init2('17.5vw','52.5vw');
				
				init2('19.5vw','49vw');
				
				init2('21.5vw','45.5vw');
				init2('21.5vw','52.5vw');
				
				init2('23.5vw','42vw');
				init2('23.5vw','49vw');
				init2('23.5vw','56vw');
				
				init2('25.5vw','45.5vw');
				init2('25.5vw','52.5vw');
				
				init2('27.5vw','42vw');
				init2('27.5vw','49vw');
				init2('27.5vw','56vw');
				
				init2('29.5vw','38.5vw');
				init2('29.5vw','45.5vw');
				init2('29.5vw','52.5vw');
				init2('29.5vw','59.5vw');
			}
			
			$(document).on("ready", function() {
				var status="off";
				$("#on").on("click",function(){
					turnOn();
					status="on";
				});
				
				$("#off").on("click",function(){
					turnOff();
					status="off";
				});
				
				$("#easy").on("click",function(){
					if(status=="on"){
						turnOn();
					}
				});
				
				$("#hard").on("click",function(){
					if(status=="on"){
						turnHard();
					}
				});
			});

			turnOff();
		</script>
	</body>
</html>